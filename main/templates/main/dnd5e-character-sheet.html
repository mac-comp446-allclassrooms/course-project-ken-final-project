<head>
	{% load static %}
	<link rel="stylesheet" href="{% static 'main.css' %}">
	<link rel="stylesheet" href="{% static 'dnd5e-character-sheet.css' %}">
	<script src="{% static 'dnd5e-character-sheet.js' %}" defer></script>

</head>

{% include 'main/index.html' %}

<body>
	
	<form id="character_sheet" method="post">
		{% csrf_token %}
		<!-- <h1>Character Sheet: {{character.name}}</h1> -->
		<div class="contentblock">
			<div class="statblock" id="profileblock">
				<div style="display: flex; justify-content: space-between;">
					<h2>{{character.name}}'s Character Profile</h2>
					<div>
						<button type="submit" id="save-character" name="save-character">Save Character</button>
						<!-- <button id="delete-button" type='submit' name="delete">Delete</button> -->
					</div>
				</div>
				<div class="contentblock" style="display: flex;">
					<table style="width: 35%;">
						<tr class="stat">
							<td>Name</td>
							<td><input type="text" id="name-display" name="character_name" value="{{character.name}}" required></td>
						</tr>

						<tr class="stat">
							<td>Species</td>
							<td><input type="text" id="species-display" name="species" value="{{character.species}}" required></td>
						</tr>

						<tr class="stat">
							<td>Class</td>
							<td><input type="text" id="class-display" name="character_class" value="{{character.character_class}}" required></td>
						</tr>
						<tr class="stat">
							<td>Level</td>
							<td><input type="number" id="level-display" name="level" value="{{character.level}}"></td>
						</tr>

						<tr class="stat">
							<td>Health</td>
							<td style="display: flex; justify-content: space-between;">
								<input type="number" id="currhealth-display" name="hp_current" value="{{character.hp_current}}" style="width: 40%;">
								<label>/</label>
								<input type="number" id="maxhealth-display" name="hp_maximum" value="{{character.hp_maximum}}" style="width: 40%;">
							</td>
						</tr>

						<tr class="stat">
							<td>Armor Class</td>
							<td><input type="number" name="armor_class" id="armorclass-display" value="10" required></td>
						</tr>
					</table>
					<textarea placeholder="Physical Description" style="resize: none; width: 30%;"></textarea>
					<div class="statblock" style="width: 35%;">
						<h2>Wallet</h2>
						<table>
							<tr>
								<th style="width: 50%;">Currency</th>
								<th style="width: 50%;">Amount</th>
							</tr>
							<tr>
								<td><label>Platinum (Pp)</label></td>
								<td><input type="number"></td>
							</tr>
							<tr>
								<td><label>Gold (Gp)</label></td>
								<td><input type="number"></td>
							</tr>
							<tr>
								<td><label>Electrum (Ep)</label></td>
								<td><input type="number"></td>
							</tr>
							<tr>
								<td><label>Silver (Sp)</label></td>
								<td><input type="number"></td>
							</tr>
							<tr>
								<td><label>Copper (Cp)</label></td>
								<td><input type="number"></td>
							</tr>
						</table>
					</div>
				</div>
			</div>
		</div>
			
		<div class="contentblock" style="display: grid; grid-template-columns: 1fr 1fr; grid-gap: 10px;">
			<div class="statblock">
				<div class='ability-scores-section'>
					<h2>Ability Scores</h2>
					<table class="contentblock" id="abilityblock">
						<tr>
							<th>Ability</th>
							<th>Score</th>
							<th>Mod</th>
							<th>Saving?</th>
						</tr>
						{% for ability in ability_scores %}
							<tr>
								<td>{{ability.name}}</td>
								<td><input type="number" class="ability-score {{ability.name}}-score" name="{{ability.name}}_ability_score" value="{{ability.score}}" min="0" max="30" onchange ="updateAbilityMod(this)"></td>
								<td>{{skill.ability_score.score}}</td>
								<td><input type="checkbox" class="saving-check-box" name="{{ability.name}}_saving_throw" onchange="updateSavingThrows()"></td>
							</tr>
						{% endfor %}
					</table>
				</div>

				<div class='saving-throws-section'>
					<h2>Saving Throws</h2>
					<table id="extra_ability_block">
					</table>
				</div>
			</div>



			<div class="statblock">
				<h2>Skill Scores</h2>
				<table class="contentblock" id="skillblock">
					<tr>
						<th style="width: 20%;">Prof</th>
						<th style="width: 30%;">Skill</th>
						<th style="width: 30%;">Ability</th>
						<th style="width: 20%;">Mod</th>
					</tr>
					{% for skill in skills %}
						<tr>
							<td><input type="number" class='level-input'  name="{{skill.name}}_{{skill.ability_score.name}}_skill" value={{skill.proficiency}} min="0" max="2" step="0.5" onchange="updateAllAbilities()"></td>
							<!-- <td>
								<select class='level-input'  name="{{skill.name}}_{{skill.ability_score.name}}_skill" onchange="updateAllAbilities()">
									<option value=0>0</option>
									<option value=1>1</option>
									<option value=2>2</option>
									<option value=0.5>0.5</option>
								</select>
							</td> -->
							<td>{{skill.name}}</td>
							<td>({{skill.ability_score.name}})</td>
							<td class="skill-score {{skill.ability_score.name}}-skill">{{skill.ability_score.score}}</td>
						</tr>					
					{% endfor %}
				</table>
			</div>
		</div>

		<div class="contentblock">
			<div class="statblock">
				<div style="display: flex; justify-content: space-between;">
					<h2>Attack</h2>
				<button type="button" onclick="createNewAttack()">Create Attack</button>
				</div>
				<table id="attackblock">
					<tr>
						<th>
							<label>Name</label>
						</th>
						<th>
							<label>Range</label>
						</th>
						<th>
							<label>Damage Roll</label>
						</th>
                        <th>
							<label>Bonus</label>
						</th>
						<th>
							<label>Damage Type</label>
						</th>
                        <th>
                            <label>Notes</label>
                        </th>
						<th></th>
					</tr>

					{% for attack in attacks %}
					<tr>
						<td><input type='number' class='level-input' value='{{attack.name}}'></input></td>
						<td> <input type='text' value='{{attack.range}}'></input></td>
						<td><input type='text' value='{{attack.damage_amount}}'></input></td>
						<td><input type='text' value='{{attack.attack_bonus}}'></input></td>
						<td><input type='text' value='{{attack.damage_type}}'></input></td>
						<td><input type='text' value='{{attack.notes}}'></input></td>
						<td><button type='button' onclick = 'deleteSpell(this)'>Delete</button></td>
					</tr>
					{% endfor %}

				</table>
			</div>
			<div class="statblock">
				<h2>Spellcasting</h2>
				<div class="contentblock" style="display: flex;">
					<div class="statblock" style="width: 35%;"">
						<table>
							<tr>
								<th><label>Spellcasting Ability</label></th>
								<td>
									<select name="spellcasting_ability">
										<option value="none">None</option>
										{% for ability in ability_scores %}
											<option value="{{ability.name}}">{{ability.name}}</option>
										{% endfor %}
									</select>
								</td>
							</tr>
							<tr>
								<th>Spellcasting Mod</th>
								<td>0</td>
							</tr>
							<tr>
								<th><label>Spell Save DC</label></th>
								<td>0</td>
							</tr>
							<tr>
								<th>Spell Attack Bonus</th>
								<td>0</td>
							</tr>
						</table>
					</div>
					<div class="statblock" style="width: 65%;">
						<!-- <h3>Spellslots</h3> -->
						<table>
							<tr>
								<th style="width: 10%;">Level</th>
								<th style="width: 23%;">Slots</th>
								<th style="width: 10%;">Level</th>
								<th style="width: 23%;">Slots</th>
								<th style="width: 10%;">Level</th>
								<th style="width: 23%;">Slots</th>
							</tr>
							<tr>
								<td>1</td>
								<td><input type="number" style="width: 40%;">
								<label>/</label>
								<input type="number" style="width: 40%;"></td>
								<td>2</td>
								<td><input type="number" style="width: 40%;">
								<label>/</label>
								<input type="number" style="width: 40%;"></td>
								<td>3</td>
								<td><input type="number" style="width: 40%;">
								<label>/</label>
								<input type="number" style="width: 40%;"></td>
							</tr>
							<tr>
								<td>4</td>
								<td><input type="number" style="width: 40%;">
								<label>/</label>
								<input type="number" style="width: 40%;"></td>
								<td>5</td>
								<td><input type="number" style="width: 40%;">
								<label>/</label>
								<input type="number" style="width: 40%;"></td>
								<td>6</td>
								<td><input type="number" style="width: 40%;">
								<label>/</label>
								<input type="number" style="width: 40%;"></td>
							</tr>
							<tr>
								<td>7</td>
								<td><input type="number" style="width: 40%;">
								<label>/</label>
								<input type="number" style="width: 40%;"></td>
								<td>8</td>
								<td><input type="number" style="width: 40%;">
								<label>/</label>
								<input type="number" style="width: 40%;"></td>
								<td>9</td>
								<td><input type="number" style="width: 40%;">
								<label>/</label>
								<input type="number" style="width: 40%;"></td>
							</tr>
						</table>
					</div>
				</div>
				<div class="statblock">
					<div style="display: flex; justify-content: space-between;">
						<h3>Spells</h3>
						<button type="button" onclick="createNewSpell()">Create Spell</button>
					</div>
					<table id="spellblock">
						<tr>
							<th>
								<label>Level</label>
							</th>
							<th>
								<label>Name</label>
							</th>
							<th>
								<label>Description</label>
							</th>
							<th>
								<label>Attack</label>
							</th>
							<th>
								<label>Save</label>
							</th>
							<th>
								<label>School</label>
							</th>
							<th></th>
						</tr>

						{% for spell in spells %}
						<tr>
							<td><input type='number' class='level-input' value='{{spell.level}}'></input></td>
							<td> <input type='text' value='{{spell.name}}'></input></td>
							<td><input type='text' value='{{spell.description}}'></input></td>
							<td><input type='text' value='{{spell.attack}}'></input></td>
							<td><input type='text' value='{{spell.save}}'></input></td>
							<td><input type='text' value='{{spell.school}}'></input></td>
							<td><button type='button' onclick = 'deleteSpell(this)'>Delete</button></td>
						</tr>
						{% endfor %}
					</table>
				</div>
			</div>
			<div class="statblock">
				<div style="display: flex; justify-content: space-between;">
					<h2>Inventory</h2>
				<button type="button" onclick="createNewItem()">Create Item</button>
				</div>
				<table id="inventoryblock">
					<tr>
						<th>
							<label>Quantity</label>
						</th>
						<th>
							<label>Name</label>
						</th>
						<th>
							<label>Description</label>
						</th>
						<th>
							<label>Weight</label>
						</th>
						<th></th>
					</tr>
					{% for item in items %}
					<tr>
						<td><input type='number' name='item_quantity' value='{{item.amount}}'></input></td><td><input type='text' name='item_name' value="{{item.name}}"></input></td>
						<td><input type='text' name='item_description' value="{{item.description}}"></input></td>
						<td><input type='number' name='item_weight' value="{{item.weight}}"></input></td>
            			<td><button type='button' onclick = 'deleteItem(this)'>delete</button></td>
					</tr>
					{% endfor %}
				</table>
			</div>
		</div>
	</form>
</body>
